<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Nutrilio Clone - Calorie Tracker</title>
<style>
    body { margin:0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background:#f7f7f7; }
    header { text-align:center; padding:20px; background:#1abc9c; color:white; font-size:1.8em; font-weight:bold; }
    main { display:flex; flex-direction:column; align-items:center; padding:10px; }

    /* Central circle */
    .circle-container { position:relative; width:250px; height:250px; margin:20px 0; }
    .circle-bg { width:100%; height:100%; border-radius:50%; background:#eee; position:absolute; top:0; left:0; }
    .circle-progress { width:100%; height:100%; border-radius:50%; clip: rect(0px, 250px, 250px, 125px); position:absolute; top:0; left:0; }
    .circle-progress .fill { background: conic-gradient(#3498db 0%, #2ecc71 0%, #e74c3c 0%, #eee 0%); width:100%; height:100%; border-radius:50%; transform:rotate(0deg); }
    .circle-text { position:absolute; width:100%; height:100%; display:flex; justify-content:center; align-items:center; flex-direction:column; font-weight:bold; font-size:1em; text-align:center; }

    /* Meal cards */
    .meal-card { background:white; width:90%; max-width:400px; border-radius:15px; padding:15px; margin:10px 0; box-shadow:0 4px 6px rgba(0,0,0,0.1); }
    .meal-card h3 { margin:0 0 10px 0; font-size:1.2em; }
    .meal-list li { margin:5px 0; font-size:0.9em; }
    .meal-progress { height:8px; border-radius:4px; margin-top:5px; background:#eee; overflow:hidden; }
    .meal-progress div { height:100%; }

    /* Tabs */
    nav { display:flex; justify-content:center; margin:10px 0; flex-wrap:wrap; }
    nav button { padding:10px 15px; margin:5px; border:none; border-radius:8px; background:#bdc3c7; color:white; font-weight:bold; cursor:pointer; }
    nav button.active { background:#1abc9c; }

    .tab { display:none; width:100%; max-width:500px; }
    .tab.active { display:block; }

    /* Inputs */
    input, select, button { margin:5px 0; padding:10px; border-radius:8px; border:1px solid #ccc; width:100%; box-sizing:border-box; }
    button { background:#1abc9c; color:white; border:none; font-weight:bold; cursor:pointer; }

    /* Week view */
    .week-day { background:white; padding:10px; border-radius:10px; margin:5px 0; box-shadow:0 2px 4px rgba(0,0,0,0.1); }
    .week-day h4 { margin:0 0 5px 0; }
    .week-progress { height:6px; border-radius:3px; background:#eee; overflow:hidden; }
    .week-progress div { height:100%; }

</style>
</head>
<body>
<header>Nutrilio Clone</header>
<nav>
    <button class="tab-btn active" data-tab="today">Сегодня</button>
    <button class="tab-btn" data-tab="week">Неделя</button>
    <button class="tab-btn" data-tab="add">Добавить</button>
    <button class="tab-btn" data-tab="settings">API Настройки</button>
</nav>
<main>

<!-- Сегодня -->
<div id="today" class="tab active">
    <div class="circle-container">
        <div class="circle-bg"></div>
        <div class="circle-progress"><div id="circleFill" class="fill"></div></div>
        <div class="circle-text">
            <span id="caloriesText">0 / 2000 kcal</span>
            <small>Б:0 Ж:0 У:0</small>
        </div>
    </div>

    <div class="meal-card" id="breakfast">
        <h3>Завтрак</h3>
        <ul class="meal-list"></ul>
        <div class="meal-progress"><div class="fill" id="breakfastProgress" style="background:#3498db;width:0%"></div></div>
        <button onclick="addMeal('breakfast')">Добавить</button>
    </div>

    <div class="meal-card" id="lunch">
        <h3>Обед</h3>
        <ul class="meal-list"></ul>
        <div class="meal-progress"><div class="fill" id="lunchProgress" style="background:#2ecc71;width:0%"></div></div>
        <button onclick="addMeal('lunch')">Добавить</button>
    </div>

    <div class="meal-card" id="dinner">
        <h3>Ужин</h3>
        <ul class="meal-list"></ul>
        <div class="meal-progress"><div class="fill" id="dinnerProgress" style="background:#e74c3c;width:0%"></div></div>
        <button onclick="addMeal('dinner')">Добавить</button>
    </div>

    <div class="meal-card" id="snacks">
        <h3>Перекусы</h3>
        <ul class="meal-list"></ul>
        <div class="meal-progress"><div class="fill" id="snacksProgress" style="background:#f1c40f;width:0%"></div></div>
        <button onclick="addMeal('snacks')">Добавить</button>
    </div>
</div>

<!-- Неделя -->
<div id="week" class="tab">
    <h2>Календарь на неделю</h2>
    <div id="weekList"></div>
</div>

<!-- Добавление еды -->
<div id="add" class="tab">
    <h2>Добавить еду</h2>
    <input type="text" id="foodName" placeholder="Название продукта">
    <input type="number" id="foodAmount" placeholder="Граммы">
    <input type="number" id="foodCalories" placeholder="Калории">
    <input type="number" id="foodProtein" placeholder="Белки">
    <input type="number" id="foodFat" placeholder="Жиры">
    <input type="number" id="foodCarbs" placeholder="Углеводы">
    <select id="foodMeal">
        <option value="breakfast">Завтрак</option>
        <option value="lunch">Обед</option>
        <option value="dinner">Ужин</option>
        <option value="snacks">Перекус</option>
    </select>
    <button onclick="saveFood()">Сохранить</button>
    <h3>Распознавание по фото</h3>
    <input type="file" id="foodPhoto" accept="image/*">
    <button onclick="recognizePhoto()">Распознать</button>
    <div id="recognizedFood"></div>
</div>

<!-- Настройки API -->
<div id="settings" class="tab">
    <h2>API Настройки</h2>
    <input type="text" id="edamamAppId" placeholder="Edamam App ID">
    <input type="text" id="edamamAppKey" placeholder="Edamam App Key">
    <input type="text" id="clarifaiKey" placeholder="Clarifai API Key">
    <button onclick="saveApiKeys()">Сохранить</button>
</div>

<script>
// Tabs
const tabs = document.querySelectorAll('.tab-btn');
tabs.forEach(tab => {
    tab.addEventListener('click', ()=>{
        document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('active'));
        document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
        tab.classList.add('active');
        document.getElementById(tab.dataset.tab).classList.add('active');
    });
});

// Data
let data = { breakfast: [], lunch: [], dinner: [], snacks: [] };
let dailyCalories = 2000;

function updateCircle() {
    let totalCalories=0, totalProtein=0, totalFat=0, totalCarbs=0;
    for(let meal in data){
        data[meal].forEach(f=>{ totalCalories+=f.calories; totalProtein+=f.protein; totalFat+=f.fat; totalCarbs+=f.carbs; });
    }
    document.getElementById('caloriesText').innerHTML = `${totalCalories} / ${dailyCalories} kcal<br>Б:${totalProtein} Ж:${totalFat} У:${totalCarbs}`;
    // Circle fill update
    let percent = Math.min(totalCalories/dailyCalories*100,100);
    document.getElementById('circleFill').style.background = `conic-gradient(#3498db ${percent*0.4}%, #2ecc71 ${percent*0.4}% ${percent*0.7}%, #e74c3c ${percent*0.7}% ${percent}%, #eee 0%)`;
}

function renderMeals(){
    for(let meal in data){
        let ul = document.getElementById(meal).querySelector('.meal-list');
        ul.innerHTML = '';
        data[meal].forEach(f=>{ ul.innerHTML += `<li>${f.name} ${f.amount}g - ${f.calories} kcal (Б:${f.protein} Ж:${f.fat} У:${f.carbs})</li>`});
        // Update progress bar
        let totalMealCalories = data[meal].reduce((a,b)=>a+b.calories,0);
        let width = Math.min(totalMealCalories/dailyCalories*100,100);
        document.getElementById(meal+'Progress').style.width = width+'%';
    }
    updateCircle();
}

function addMeal(meal){
    document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
    document.querySelector('[data-tab="add"]').classList.add('active');
    document.getElementById('foodMeal').value = meal;
}

function saveFood(){
    const f = {
        name: document.getElementById('foodName').value,
        amount: parseInt(document.getElementById('foodAmount').value),
        calories: parseInt(document.getElementById('foodCalories').value),
        protein: parseInt(document.getElementById('foodProtein').value),
        fat: parseInt(document.getElementById('foodFat').value),
        carbs: parseInt(document.getElementById('foodCarbs').value)
    };
    const meal = document.getElementById('foodMeal').value;
    data[meal].push(f);
    renderMeals();
    alert('Продукт добавлен!');
}

function saveApiKeys(){
    localStorage.setItem('edamamAppId', document.getElementById('edamamAppId').value);
    localStorage.setItem('edamamAppKey', document.getElementById('edamamAppKey').value);
    localStorage.setItem('clarifaiKey', document.getElementById('clarifaiKey').value);
    alert('Ключи сохранены!');
}

function recognizePhoto(){
    const file = document.getElementById('foodPhoto').files[0];
    if(!file) return alert('Выберите фото');
    const key = localStorage.getItem('clarifaiKey');
    if(!key) return alert('Установите Clarifai API Key в настройках');
    document.getElementById('recognizedFood').innerText = 'Распознавание: пример продукта';
}

// Week view
function renderWeek(){
    let weekDiv = document.getElementById('weekList');
    weekDiv.innerHTML = '';
    for(let i=0;i<7;i++){
        weekDiv.innerHTML += `<div class="week-day"><h4>День ${i+1}</h4><div class="week-progress"><div style="width:${Math.floor(Math.random()*100)}%;background:#1abc9c"></div></div></div>`;
    }
}
renderWeek();
</script>
</main>
</body>
</html>
